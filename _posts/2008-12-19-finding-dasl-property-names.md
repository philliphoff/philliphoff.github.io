---
layout: post
title: "Finding DASL Property Names"
date: 2008-12-19
---
<p>The LINQ-to-DASL provider of the Office Interop API Extensions provides a very limited set of mappings between its query types and their associated DASL properties.&#160; We didn't have the time to add them all and we didn't know which properties (besides the obvious ones like Subject and DateReceived) users would be most likely to use in their queries.&#160; Instead, we created an extensibility mechanism (the OutlookItemPropertyAttribute) that allowed users to add their own mappings to DASL properties.&#160; Now the problem becomes, where do we find these DASL property names?</p>  <p>You can find some of the property names amongst the MSDN Office and Exchange documentation, but many properties are missing and sometimes the documentation is misleading (e.g. a listed property may work when querying Exchange but not Outlook).&#160; Outlook supports another query syntax (Jet) that uses a different set of property names, making the documentation even more confusing.</p>  <p>The best approach that I have found is to go directly to the source.&#160; Outlook actually has a built-in DASL query builder, if only you know how to find it.&#160; Here's the trick: start with the View : Current View : Customize Current View menu item.</p>  <p><a href="/assets/posts/ViewMenu.jpg" original-url="/assets/posts/ViewMenu.jpg"><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="ViewMenu" src="/assets/posts/ViewMenu_thumb.jpg" width="444" height="333" /></a> </p>  <p>This displays the Customize View Messages dialog.&#160; </p>  <p><a href="/assets/posts/CustomizeCurrentView.jpg"><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="CustomizeCurrentView" src="/assets/posts/CustomizeCurrentView_thumb.jpg" width="482" height="332" /></a> </p>  <p>Next, click the Filter button.</p>  <p><a href="/assets/posts/AdvancedTab.jpg"><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="AdvancedTab" src="/assets/posts/AdvancedTab_thumb.jpg" width="423" height="318" /></a> </p>  <p>The filter dialog allows you to filter messages in a folder by a variety of criteria.&#160; Select the Advanced tab.</p>  <p><a href="/assets/posts/FieldMenu_2.jpg"><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="FieldMenu" src="/assets/posts/FieldMenu_thumb.jpg" width="478" height="351" /></a> </p>  <p>Now use the Field button to select the Outlook item property you are interested in.</p>  <p><a href="/assets/posts/FieldConditionAndValue.jpg" ><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="FieldConditionAndValue" src="/assets/posts/FieldConditionAndValue_thumb.jpg" width="423" height="318" /></a> </p>  <p>You can then select the condition and a value.&#160; Click the Add to List button to add the criteria to the filter.</p>  <p><a href="/assets/posts/CriteriaAdded.jpg"><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="CriteriaAdded" src="/assets/posts/CriteriaAdded_thumb.jpg" width="423" height="318" /></a></p>  <p>Finally, select the SQL tab to see the DASL.&#160; </p>  <p><a href="/assets/posts/SqlTab.jpg"><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="SqlTab" src="/assets/posts/SqlTab_thumb.jpg" width="423" height="318" /></a>&#160; </p>  <p>In this case, we see that the DASL property associated with the Modified time of an appointment is &quot;DAV:getlastmodified&quot;.&#160; To cut and paste the query string elsewhere (e.g. to Notepad, so you can compare the query string to the <a href="{% post_url 2008-12-18-debugging-linq-to-dasl-queries %}">debug output of your LINQ-to-DASL query</a>), check the box at the bottom of the tab.</p>  <p><a href="/assets/posts/SelectedDasl.jpg"><img style="border-right-width: 0px; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" border="0" alt="SelectedDasl" src="/assets/posts/SelectedDasl_thumb.jpg" width="423" height="318" /></a></p>